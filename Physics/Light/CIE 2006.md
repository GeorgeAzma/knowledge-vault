SML cone sensitivity in human eye to different [[Light|Wavelengths]]
![[Spectral Sensitivity.webp]]
Modern version of [[CIE 1931]]
### Experiment
- **wavelength range** `390nm-830nm`, step size `1nm`
- some crazy complex stuff to get `LMS` cone responses for each wavelength
### Wavelength To LMS
``` c
// Fitted to CIE 2006 2Â° cone fundamentals by Stockman & Sharp 2000
vec3 wave2lms(float wave, vec3 amount) {
    #define gauss(x, u, o, A) A / o * exp(-0.5 * pow((x - u) / o, 2.0))
	return vec3(
		// L cone response curve
		gauss(wave, 449.682, 21.6622, 2.366120) +
		gauss(wave, 477.589, 11.0682, 1.398830) +
		gauss(wave, 532.488, 25.7494, 34.04780) +
		gauss(wave, 570.200, 5.91487, 0.243387) +
		gauss(wave, 585.858, 34.9800, 77.86690),

		// M cone response curve
		gauss(wave, 450.237, 19.5222, 3.335370) +
		gauss(wave, 479.559, 13.3211, 3.688130) +
		gauss(wave, 519.924, 17.1502, 9.684840) +
		gauss(wave, 542.800, 3.27696, 0.105766) +
		gauss(wave, 552.158, 33.3895, 77.92980),

		// S cone response curve
		gauss(wave, 467.661, 8.84562,  5.3207300) +
		gauss(wave, 422.211, 10.2028,  8.5849800) +
		gauss(wave, 443.084, 11.9848,  19.634700) +
		gauss(wave, 444.863, 1.30608, -0.0330768) +
		gauss(wave, 460.886, 25.7907,  24.912800)
	) / sqrt(6.2831);
}
```
### LMS To XYZ
$$
\begin{bmatrix}X\\ Y \\ Z\end{bmatrix}_F=
\begin{bmatrix}1.94735469 & -1.41445123 & 0.36476327 \\ 0.68990272 & 0.34832189 & 0 \\ 0 & 0 & 1.93485343\end{bmatrix}
\begin{bmatrix}L\\ M \\ S\end{bmatrix}
$$
$$
\begin{bmatrix}L \\ M \\ S\end{bmatrix}=
\begin{bmatrix} 0.210576 & 0.855098 & -0.0396983 \\ -0.417076 & 1.177260 & 0.0786283 \\ 0 & 0 & 0.5168350 \end{bmatrix} 
 \begin{bmatrix}X \\ Y \\ Z\end{bmatrix}_F
$$
